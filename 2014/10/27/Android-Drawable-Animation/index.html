<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
    <link rel="alternate icon" type="image/png" href="/img/favicon.png">
    
        <title>Android Drawable Animation </title>
    
    
<link rel="stylesheet" href="/css/reset.css">

    
<link rel="stylesheet" href="/css/style.css">

    
<link rel="stylesheet" href="/css/markdown.css">

    
<link rel="stylesheet" href="/css/fonts.css">

<meta name="generator" content="Hexo 6.3.0"></head>
    <body>
        <div class="paper">
            <div class="paper-main">
                
                    <div class="post-header">
    <p class="post-title">Android Drawable Animation</p>
</div>
                
                <div class="post-main">

    
        <div class="post-meta">
            <a class='author' href="/">罗昭成</a> <span id="clipboardbtn" 
            data-clipboard-action="copy"
            data-clipboard-target="#copy-post-content"
            >2014年10月27日</span>
        </div>
        <div class="post-md" id="copy-post-content">
            <p>ProgressBar是一个经常使用的组件，但很多时候，它的外观看起来并不能满足我们的需求。<br>对它进行自定义也很麻烦。</p>
<p>有一个很简单的解决办法就是用GIF动画，不使用系统提供的ProgressBar。</p>
<p>有关显示GIF动画，网上有很多例子，这里只介绍将GIF动态图按每一帧切出来，然后在使用<br>Frame Animation将它展示出来。</p>
<p>先上代码<code>loading.xml</code>：</p>
<pre><code class="html">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;animation-list android:id=&quot;@+id/loading_animation&quot; android:oneshot=&quot;false&quot;
  xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;
    &lt;item android:duration=&quot;@integer/loading_frame_interval&quot; android:drawable=&quot;@drawable/loading_00&quot; /&gt;
    &lt;item android:duration=&quot;@integer/loading_frame_interval&quot; android:drawable=&quot;@drawable/loading_01&quot; /&gt;
    &lt;item android:duration=&quot;@integer/loading_frame_interval&quot; android:drawable=&quot;@drawable/loading_02&quot; /&gt;
    &lt;item android:duration=&quot;@integer/loading_frame_interval&quot; android:drawable=&quot;@drawable/loading_03&quot; /&gt;
    &lt;item android:duration=&quot;@integer/loading_frame_interval&quot; android:drawable=&quot;@drawable/loading_04&quot; /&gt;
    &lt;item android:duration=&quot;@integer/loading_frame_interval&quot; android:drawable=&quot;@drawable/loading_05&quot; /&gt;
    &lt;item android:duration=&quot;@integer/loading_frame_interval&quot; android:drawable=&quot;@drawable/loading_06&quot; /&gt;
    &lt;item android:duration=&quot;@integer/loading_frame_interval&quot; android:drawable=&quot;@drawable/loading_07&quot; /&gt;
    &lt;item android:duration=&quot;@integer/loading_frame_interval&quot; android:drawable=&quot;@drawable/loading_08&quot; /&gt;
    &lt;item android:duration=&quot;@integer/loading_frame_interval&quot; android:drawable=&quot;@drawable/loading_09&quot; /&gt;
    &lt;item android:duration=&quot;@integer/loading_frame_interval&quot; android:drawable=&quot;@drawable/loading_10&quot; /&gt;
    &lt;item android:duration=&quot;@integer/loading_frame_interval&quot; android:drawable=&quot;@drawable/loading_11&quot; /&gt;
    &lt;item android:duration=&quot;@integer/loading_frame_interval&quot; android:drawable=&quot;@drawable/loading_12&quot; /&gt;
    &lt;item android:duration=&quot;@integer/loading_frame_interval&quot; android:drawable=&quot;@drawable/loading_13&quot; /&gt;
    &lt;item android:duration=&quot;@integer/loading_frame_interval&quot; android:drawable=&quot;@drawable/loading_14&quot; /&gt;
    &lt;item android:duration=&quot;@integer/loading_frame_interval&quot; android:drawable=&quot;@drawable/loading_15&quot; /&gt;
&lt;/animation-list&gt;
</code></pre>
<p>其中:</p>
<pre><code class="html">&lt;integer name=&quot;loading_frame_interval&quot;&gt;30&lt;/integer&gt;
</code></pre>
<p>在使用的时候，因为网上说的种种bug，我直接自定义了一个<code>ImageView</code>，用来显示Loading View。 看源码：</p>
<pre><code class="java">package cn.lovecluo.widget;

import android.content.Context;
import android.graphics.Canvas;
import android.graphics.drawable.AnimationDrawable;
import android.util.AttributeSet;
import android.widget.ImageView;

/**
 * Create by luozc at Aug 21, 2014
 */
public class CustomeImageView extends ImageView &#123;

    public CustomeImageView(Context context, AttributeSet attrs, int defStyle) &#123;
        super(context, attrs, defStyle);
        this.initView();
    &#125;

    public CustomeImageView(Context context, AttributeSet attrs) &#123;
        super(context, attrs);
        this.initView();
    &#125;

    public CustomeImageView(Context context) &#123;
        super(context);
        this.initView();
    &#125;

    private void initView() &#123;
        this.setImageResource(R.drawable.loading);
    &#125;
    
    @Override
    protected void onDraw(Canvas canvas) &#123;
        super.onDraw(canvas);
        this.loading();
    &#125;   
    public void loading() &#123;
        AnimationDrawable drawable = (AnimationDrawable) this.getDrawable();
        drawable.start();
    &#125;
&#125;
</code></pre>
<p>使用的时候也很简单，在XML中添加这个<code>CustomeImageView</code>即可，代码如下：</p>
<pre><code class="html">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    style=&quot;@style/fillall&quot;
    android:paddingLeft=&quot;@dimen/activity_horizontal_margin&quot;
    android:paddingRight=&quot;@dimen/activity_horizontal_margin&quot; &gt;
    &lt;cn.lovecluo.widget.CustomeImageView 
        style=&quot;@style/wrap&quot;
        android:layout_centerInParent=&quot;true&quot; /&gt;
&lt;/RelativeLayout&gt;
</code></pre>
<p>当然使用场景并不仅仅是这么简单，有时候， 我们会需要在一个Button后面添加一<code>loading</code>动画,<br>就比如说在登录的时候，当然你可以定义几个组件，用代码控制每个组件的显示，但是这样子过于的麻烦。</p>
<p>就上述情况，我们还是用上面定义的<code>loading.xml</code>的动画效果来做展示:<br>在TextView中有这么几个属性:<code>drawableLeft</code>、<code>drawableRight</code>、<code>drawableTop</code>、<code>drawableBottom</code></p>
<p>在这里，我们要动态控制，所以不能将这些写到xml中去，所以只能写代码了。</p>
<pre><code class="java">Drawable drawable= mContext.getResources().getDrawable(R.drawable.loading);
/// 这一步必须要做,否则不会显示.
drawable.setBounds(0, 0, drawable.getMinimumWidth(), drawable.getMinimumHeight());
mSubmitBtn.setCompoundDrawables(drawable, null, null, null);
AnimationDrawable loadingAnimation = (AnimationDrawable) mSubmitBtn.getCompoundDrawables()[0];
loadingAnimation.start();
</code></pre>
<p>是不是很简单，当然，如果你觉得图片和文字离的太近，你可以在xml中加上<code>android:drawablePadding=&quot;8dip&quot;</code></p>
<p>看XML代码 ：</p>
<pre><code class="html">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;FrameLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    android:id=&quot;@+id/submit_framelayout&quot;
    style=&quot;@style/fillx&quot;
    android:background=&quot;@drawable/add_service_input_btn_bg&quot;
    android:clickable=&quot;true&quot;
    android:padding=&quot;@dimen/activity_horizontal_margin&quot; &gt;

    &lt;Button
        android:id=&quot;@+id/submit_btn&quot;
        style=&quot;@style/wrap&quot;
        android:layout_gravity=&quot;center&quot;
        android:background=&quot;@null&quot;
        android:drawablePadding=&quot;@dimen/dp8&quot;
        android:text=&quot;@string/submit&quot;
        android:textColor=&quot;@color/white&quot;
        android:textSize=&quot;@dimen/textsize_medium&quot; /&gt;

&lt;/FrameLayout&gt;
</code></pre>
<p>看了代码，你就会觉得特别的简单。</p>

        </div>

    

</div>
                <!-- 
                    <div class="post_pre_next">
    
        <div class="post-pre">
            <a href="/2014/11/03/NullPointException%20Analysis/">上一篇: Android 项目中出现的奇葩bug, 数据NullPointExcption</a>
        </div>
    
    
        <a href="/2014/10/26/Android-blur-image/">下一篇: 
            Android 图片的毛玻璃效果
        </a>
    
</div>


                 -->
                <div class="footer">
    <span>Copyright © 2023 大罗说事</span>
</div>

<!-- 
<link rel="stylesheet" href="/css/highlight.default.css">
 -->

<link rel="stylesheet" href="/css/atom-one-dark.css">


<link rel="stylesheet" href="/css/code-theme.css">


<script src="/js/highlight.min.js"></script>


<script src="/js/highlightjs-line-numbers.js"></script>


<script src="/js/clipboard.min.js"></script>


<script>
    hljs.highlightAll();
    var clipboard = new ClipboardJS('#clipboardbtn');
    clipboard.on('success', function (e) {
        console.log("Copied")
        e.clearSelection();  
    });

    clipboard.on('error', function (e) {
        console.log(e);
    });
</script>

            </div>
        </div>
    </body>
</html>